{
  "name": "HashiCorp Vault",
  "description": "Secret management and credential lifecycle — store, rotate, and audit access to secrets",
  "mcp_package": "@hashicorp/vault-mcp-server",
  "source": "https://github.com/hashicorp/vault-mcp-server",
  "maturity": "Official",
  "auth_method": "Vault Token / AppRole",

  "config": {
    "command": "npx",
    "args": ["-y", "@hashicorp/vault-mcp-server"],
    "env": {
      "VAULT_ADDR": "${VAULT_ADDR}",
      "VAULT_TOKEN": "${VAULT_TOKEN}"
    }
  },

  "capabilities": {
    "tools": [
      "read_secret — Read secret from KV store",
      "write_secret — Write/rotate a secret",
      "list_secrets — List secret paths",
      "generate_credentials — Generate dynamic credentials",
      "revoke_lease — Revoke a credential lease"
    ],
    "access_type": "Read/Write (policy-controlled)",
    "data_sources": ["KV secrets engine", "Dynamic secrets", "PKI", "Transit"]
  },

  "setup_steps": [
    "1. Deploy Vault (or use HCP Vault)",
    "2. Create a dedicated policy for MCP access:",
    "   path \"secret/data/mcp/*\" { capabilities = [\"read\", \"list\"] }",
    "   path \"secret/data/rotate/*\" { capabilities = [\"create\", \"update\"] }",
    "3. Create an AppRole or token bound to this policy",
    "4. Set VAULT_ADDR and auth credentials"
  ],

  "security_notes": [
    "MCP policy should be scoped to specific secret paths only",
    "Use AppRole auth instead of static tokens for production",
    "Rotation actions should require human approval in the AI workflow",
    "All Vault access is audited — ensure audit device is enabled",
    "Never expose the root token to MCP — use a dedicated limited token"
  ]
}
