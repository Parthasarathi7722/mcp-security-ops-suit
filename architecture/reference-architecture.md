# Reference Architecture

## Full Stack Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         SOC ANALYST INTERFACE                               â”‚
â”‚                                                                             â”‚
â”‚   Browser UI (http://localhost:8000)    CLI (python agent.py)              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚  Chat  â”‚ Playbooks â”‚ Reports     â”‚  â”‚ agent.py --playbook vuln-triageâ”‚  â”‚
â”‚   â”‚  âš™ AI Engine  â”‚  ğŸ”Œ MCP Tools   â”‚  â”‚ "CVE-2024-50623 in payments-api"â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   HTTP API (SSE)             WebSocket               SIEM Webhook          â”‚
â”‚   POST /query                WS /ws/{session_id}     POST /webhook/siem    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚    server.py        â”‚
                              â”‚    FastAPI app      â”‚
                              â”‚                     â”‚
                              â”‚  â€¢ REST endpoints   â”‚
                              â”‚  â€¢ WebSocket handlerâ”‚
                              â”‚  â€¢ Session store    â”‚
                              â”‚  â€¢ UI serving       â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚    agent.py         â”‚
                              â”‚  run_investigation()â”‚
                              â”‚  (async generator)  â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
               â”‚                        â”‚                        â”‚
        AI_PROVIDER=demo        AI_PROVIDER=anthropic    AI_PROVIDER=openai
        (pre-recorded)          (Anthropic API)          (Ollama/LM Studio/
                                                          vLLM/any OpenAI-
                                                          compatible endpoint)
                                        â”‚
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚                    â”‚
                        MCP_MODE=mock        MCP_MODE=live
                        (sample data)        mcp_client.py
                                             MCPClientPool
                                             asyncio.gather()
                                                    â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”
              â”‚      â”‚         â”‚          â”‚         â”‚      â”‚      â”‚
           npx/uvx subprocess per MCP server (stdio JSON-RPC)
              â”‚      â”‚         â”‚          â”‚         â”‚      â”‚      â”‚
          Sentinel  GHAS  GreyNoise   OpenCTI    Vault  Prowler  Jira
          Splunk    Snyk  VirusTotal  Detections  Okta  Cloudflare Slack
          â€¦         â€¦    â€¦           â€¦           â€¦     â€¦         â€¦
```

---

## Data Flow: Incident Response

```
   Alert Fires                 SOCPilot Correlates          SOCPilot Responds
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Sentinel     â”‚          â”‚                   â”‚       â”‚                  â”‚
â”‚ "Suspicious  â”‚â”€â”€â”€â”€â”€â”€â–¶   â”‚ run_investigation()â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ Auto-generated:  â”‚
â”‚  login from  â”‚          â”‚                   â”‚       â”‚                  â”‚
â”‚  unusual IP" â”‚          â”‚ 1. Query Sentinel â”‚       â”‚ - Jira P1 ticket â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    for full event â”‚       â”‚   with timeline  â”‚
                          â”‚                   â”‚       â”‚                  â”‚
  Or via webhook:         â”‚ 2. GreyNoise:     â”‚       â”‚ - Slack alert    â”‚
  POST /webhook/siem      â”‚    IP reputation  â”‚       â”‚   to #incidents  â”‚
                          â”‚                   â”‚       â”‚                  â”‚
                          â”‚ 3. OpenCTI:       â”‚       â”‚ - Okta: disable  â”‚
                          â”‚    Threat actor   â”‚       â”‚   compromised    â”‚
                          â”‚    attribution?   â”‚       â”‚   session        â”‚
                          â”‚                   â”‚       â”‚   (with approval)â”‚
                          â”‚ 4. Okta:          â”‚       â”‚                  â”‚
                          â”‚    User's recent  â”‚       â”‚ - Vault: rotate  â”‚
                          â”‚    activity       â”‚       â”‚   affected keys  â”‚
                          â”‚                   â”‚       â”‚   (with approval)â”‚
                          â”‚ 5. Vault Radar:   â”‚       â”‚                  â”‚
                          â”‚    Any secrets    â”‚       â”‚ - Cloudflare:    â”‚
                          â”‚    exposed?       â”‚       â”‚   block IP in    â”‚
                          â”‚                   â”‚       â”‚   WAF            â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow: Vulnerability Triage

```
  New Finding              SOCPilot Enriches             SOCPilot Prioritises
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GHAS Alert   â”‚       â”‚                  â”‚       â”‚                       â”‚
â”‚ "Critical    â”‚â”€â”€â–¶    â”‚ 1. GHAS: full    â”‚â”€â”€â–¶    â”‚ Risk Assessment:      â”‚
â”‚  CVE in      â”‚       â”‚    alert details â”‚       â”‚                       â”‚
â”‚  lodash"     â”‚       â”‚    + affected    â”‚       â”‚ "CVE-2024-XXXX in     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    repos         â”‚       â”‚  lodash is critical   â”‚
                       â”‚                  â”‚       â”‚  but NOT reachable    â”‚
  Or free-form chat:   â”‚ 2. Snyk:         â”‚       â”‚  in your code path.   â”‚
  "triage CVE-â€¦"       â”‚    reachable?    â”‚       â”‚  GreyNoise confirms   â”‚
                       â”‚    transitive?   â”‚       â”‚  active exploitation. â”‚
                       â”‚                  â”‚       â”‚  Recommend: upgrade   â”‚
                       â”‚ 3. GreyNoise:    â”‚       â”‚  to 4.17.21 within   â”‚
                       â”‚    active        â”‚       â”‚  48h."                â”‚
                       â”‚    exploitation? â”‚       â”‚                       â”‚
                       â”‚                  â”‚       â”‚ â†’ Creates Jira ticket â”‚
                       â”‚ 4. OpenCTI:      â”‚       â”‚   Priority: P2        â”‚
                       â”‚    threat actor  â”‚       â”‚   SLA: 48 hours       â”‚
                       â”‚    campaigns?    â”‚       â”‚   Assignee: DevTeam   â”‚
                       â”‚                  â”‚       â”‚                       â”‚
                       â”‚ 5. Security      â”‚       â”‚ â†’ Posts to Slack      â”‚
                       â”‚    Detections:   â”‚       â”‚   #vuln-triage        â”‚
                       â”‚    Sigma rules   â”‚       â”‚                       â”‚
                       â”‚    for this CVE? â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Tiers

### Tier 1: Solo Analyst (Free)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SOCPilot                         â”‚
â”‚  (AI_PROVIDER=demo or anthropic/ollama)       â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ GHAS â”‚  â”‚Semgrep â”‚  â”‚ GreyNoise        â”‚ â”‚
â”‚  â”‚(free)â”‚  â”‚ (free) â”‚  â”‚ (community free) â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Security Detections (Sigma/ESCU) â€” free â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tier 2: Team SOC

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SOCPilot                              â”‚
â”‚                                                          â”‚
â”‚  DETECT          INVESTIGATE        RESPOND              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ GHAS â”‚        â”‚ Sentinel â”‚       â”‚ Jira â”‚            â”‚
â”‚  â”‚Semgrepâ”‚       â”‚ Splunk   â”‚       â”‚ Slackâ”‚            â”‚
â”‚  â”‚ Snyk â”‚        â”‚GreyNoise â”‚       â”‚ Vaultâ”‚            â”‚
â”‚  â”‚ Trivyâ”‚        â”‚ Detectionsâ”‚      â”‚      â”‚            â”‚
â”‚  â”‚Prowlerâ”‚       â”‚ OpenCTI  â”‚       â”‚      â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tier 3: Enterprise

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SOCPilot â€” Enterprise                                â”‚
â”‚                                                                          â”‚
â”‚  DETECT            INVESTIGATE          RESPOND          COMPLY          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ GHAS     â”‚      â”‚ Sentinel     â”‚     â”‚ Jira      â”‚   â”‚ Drata      â”‚ â”‚
â”‚  â”‚ Semgrep  â”‚      â”‚ Splunk       â”‚     â”‚ Slack     â”‚   â”‚ Vanta      â”‚ â”‚
â”‚  â”‚ Snyk     â”‚      â”‚ Elastic      â”‚     â”‚ Vault     â”‚   â”‚ Prowler    â”‚ â”‚
â”‚  â”‚ Trivy    â”‚      â”‚ Datadog      â”‚     â”‚ Okta      â”‚   â”‚            â”‚ â”‚
â”‚  â”‚ StackHawkâ”‚      â”‚ GreyNoise    â”‚     â”‚ Cloudflareâ”‚   â”‚            â”‚ â”‚
â”‚  â”‚ Prowler  â”‚      â”‚ OpenCTI      â”‚     â”‚           â”‚   â”‚            â”‚ â”‚
â”‚  â”‚          â”‚      â”‚ Vault Radar  â”‚     â”‚           â”‚   â”‚            â”‚ â”‚
â”‚  â”‚          â”‚      â”‚ VirusTotal   â”‚     â”‚           â”‚   â”‚            â”‚ â”‚
â”‚  â”‚          â”‚      â”‚ Detections   â”‚     â”‚           â”‚   â”‚            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Tool Categories

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DETECT                                          â”‚
â”‚    GHAS         Semgrep       Snyk          Trivy       StackHawk       â”‚
â”‚  (Dependabot,   (SAST,        (SCA,         (Container  (DAST,          â”‚
â”‚   CodeQL,       5000+ rules)  Reachability, SBOM)       API testing)    â”‚
â”‚   Secrets)                    License)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        INVESTIGATE                                      â”‚
â”‚    Sentinel     Splunk        Elastic        Datadog     GreyNoise      â”‚
â”‚  (KQL, SIEM)  (SPL, SIEM)   (EQL/KQL)    (Metrics,   (IP reputation,  â”‚
â”‚                                            Logs, RCA)  active exploits) â”‚
â”‚                                                                         â”‚
â”‚    OpenCTI      VirusTotal    Vault Radar   Security Detections         â”‚
â”‚  (Threat actors,(Hash/URL/IP  (Secret       (Sigma, ESCU,               â”‚
â”‚   IOCs, MITRE)  analysis)     scanning)     KQL rules)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         RESPOND                                         â”‚
â”‚    Jira         Slack         Vault         Okta        Cloudflare      â”‚
â”‚  (Tickets,    (Alerts,      (Rotate,      (Sessions,  (WAF rules,      â”‚
â”‚   SLA track)   Updates)      Revoke)       Deprov)     Zero Trust)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         COMPLY                                          â”‚
â”‚    Prowler      Drata         Vanta                                     â”‚
â”‚  (CIS/SOC2,   (Compliance   (Compliance                                 â”‚
â”‚   Cloud scan)  framework)    framework)                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## MCP Protocol: How It Works

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SOCPilot     â”‚                    â”‚   MCP Server      â”‚
â”‚  (MCP Host)   â”‚                    â”‚   (e.g. Sentinel) â”‚
â”‚               â”‚                    â”‚                   â”‚
â”‚  User asks:   â”‚   â”€â”€ initialize â”€â”€â–¶â”‚  Declares:        â”‚
â”‚  "Check logs" â”‚                    â”‚  - tools[]        â”‚
â”‚               â”‚   â—€â”€â”€ response â”€â”€  â”‚  - resources[]    â”‚
â”‚               â”‚                    â”‚  - prompts[]      â”‚
â”‚  AI decides   â”‚                    â”‚                   â”‚
â”‚  which tool   â”‚   â”€â”€ tools/call â”€â”€â–¶â”‚  Executes:        â”‚
â”‚  to use       â”‚   { "name":        â”‚  run_kql_query()  â”‚
â”‚               â”‚     "run_kql" }    â”‚                   â”‚
â”‚               â”‚                    â”‚                   â”‚
â”‚  AI formats   â”‚   â—€â”€â”€ result â”€â”€â”€â”€  â”‚  Returns:         â”‚
â”‚  response     â”‚   { "content":     â”‚  query results    â”‚
â”‚               â”‚     [...] }        â”‚                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Transport

All MCP servers in this stack use **stdio** transport (subprocess JSON-RPC). Each MCP server runs as a child process â€” no network ports, no shared memory.

- `npx -y @package/mcp-server` â€” Node.js-based servers
- `uvx package-name` â€” Python-based servers (Semgrep, Prowler, GreyNoise)

### Parallel execution

When the AI requests multiple tool calls in a single turn (e.g., "check GreyNoise AND OpenCTI AND Sentinel"), `mcp_client.py` executes all of them concurrently via `asyncio.gather()`, then feeds all results back to the AI in a single message.

### Key concepts

- **Tools**: Actions the AI can invoke (query, scan, create ticket)
- **Resources**: Data the AI can read (findings, logs, configs)
- **Prompts**: Templates for common workflows (incident response, triage)
- **Transport**: stdio (local) or SSE (remote) â€” stdio for security-sensitive tools
